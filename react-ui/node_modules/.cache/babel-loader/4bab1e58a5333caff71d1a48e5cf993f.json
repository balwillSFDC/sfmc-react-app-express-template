{"ast":null,"code":"// Generated by CoffeeScript 1.12.7\n(function () {\n  var NodeType,\n      WriterState,\n      XMLAttribute,\n      XMLCData,\n      XMLComment,\n      XMLDTDAttList,\n      XMLDTDElement,\n      XMLDTDEntity,\n      XMLDTDNotation,\n      XMLDeclaration,\n      XMLDocType,\n      XMLDocument,\n      XMLDocumentCB,\n      XMLElement,\n      XMLProcessingInstruction,\n      XMLRaw,\n      XMLStringWriter,\n      XMLStringifier,\n      XMLText,\n      getValue,\n      isFunction,\n      isObject,\n      isPlainObject,\n      ref,\n      hasProp = {}.hasOwnProperty;\n  ref = require('./Utility'), isObject = ref.isObject, isFunction = ref.isFunction, isPlainObject = ref.isPlainObject, getValue = ref.getValue;\n  NodeType = require('./NodeType');\n  XMLDocument = require('./XMLDocument');\n  XMLElement = require('./XMLElement');\n  XMLCData = require('./XMLCData');\n  XMLComment = require('./XMLComment');\n  XMLRaw = require('./XMLRaw');\n  XMLText = require('./XMLText');\n  XMLProcessingInstruction = require('./XMLProcessingInstruction');\n  XMLDeclaration = require('./XMLDeclaration');\n  XMLDocType = require('./XMLDocType');\n  XMLDTDAttList = require('./XMLDTDAttList');\n  XMLDTDEntity = require('./XMLDTDEntity');\n  XMLDTDElement = require('./XMLDTDElement');\n  XMLDTDNotation = require('./XMLDTDNotation');\n  XMLAttribute = require('./XMLAttribute');\n  XMLStringifier = require('./XMLStringifier');\n  XMLStringWriter = require('./XMLStringWriter');\n  WriterState = require('./WriterState');\n\n  module.exports = XMLDocumentCB = function () {\n    function XMLDocumentCB(options, onData, onEnd) {\n      var writerOptions;\n      this.name = \"?xml\";\n      this.type = NodeType.Document;\n      options || (options = {});\n      writerOptions = {};\n\n      if (!options.writer) {\n        options.writer = new XMLStringWriter();\n      } else if (isPlainObject(options.writer)) {\n        writerOptions = options.writer;\n        options.writer = new XMLStringWriter();\n      }\n\n      this.options = options;\n      this.writer = options.writer;\n      this.writerOptions = this.writer.filterOptions(writerOptions);\n      this.stringify = new XMLStringifier(options);\n\n      this.onDataCallback = onData || function () {};\n\n      this.onEndCallback = onEnd || function () {};\n\n      this.currentNode = null;\n      this.currentLevel = -1;\n      this.openTags = {};\n      this.documentStarted = false;\n      this.documentCompleted = false;\n      this.root = null;\n    }\n\n    XMLDocumentCB.prototype.createChildNode = function (node) {\n      var att, attName, attributes, child, i, len, ref1, ref2;\n\n      switch (node.type) {\n        case NodeType.CData:\n          this.cdata(node.value);\n          break;\n\n        case NodeType.Comment:\n          this.comment(node.value);\n          break;\n\n        case NodeType.Element:\n          attributes = {};\n          ref1 = node.attribs;\n\n          for (attName in ref1) {\n            if (!hasProp.call(ref1, attName)) continue;\n            att = ref1[attName];\n            attributes[attName] = att.value;\n          }\n\n          this.node(node.name, attributes);\n          break;\n\n        case NodeType.Dummy:\n          this.dummy();\n          break;\n\n        case NodeType.Raw:\n          this.raw(node.value);\n          break;\n\n        case NodeType.Text:\n          this.text(node.value);\n          break;\n\n        case NodeType.ProcessingInstruction:\n          this.instruction(node.target, node.value);\n          break;\n\n        default:\n          throw new Error(\"This XML node type is not supported in a JS object: \" + node.constructor.name);\n      }\n\n      ref2 = node.children;\n\n      for (i = 0, len = ref2.length; i < len; i++) {\n        child = ref2[i];\n        this.createChildNode(child);\n\n        if (child.type === NodeType.Element) {\n          this.up();\n        }\n      }\n\n      return this;\n    };\n\n    XMLDocumentCB.prototype.dummy = function () {\n      return this;\n    };\n\n    XMLDocumentCB.prototype.node = function (name, attributes, text) {\n      var ref1;\n\n      if (name == null) {\n        throw new Error(\"Missing node name.\");\n      }\n\n      if (this.root && this.currentLevel === -1) {\n        throw new Error(\"Document can only have one root node. \" + this.debugInfo(name));\n      }\n\n      this.openCurrent();\n      name = getValue(name);\n\n      if (attributes == null) {\n        attributes = {};\n      }\n\n      attributes = getValue(attributes);\n\n      if (!isObject(attributes)) {\n        ref1 = [attributes, text], text = ref1[0], attributes = ref1[1];\n      }\n\n      this.currentNode = new XMLElement(this, name, attributes);\n      this.currentNode.children = false;\n      this.currentLevel++;\n      this.openTags[this.currentLevel] = this.currentNode;\n\n      if (text != null) {\n        this.text(text);\n      }\n\n      return this;\n    };\n\n    XMLDocumentCB.prototype.element = function (name, attributes, text) {\n      var child, i, len, oldValidationFlag, ref1, root;\n\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        this.dtdElement.apply(this, arguments);\n      } else {\n        if (Array.isArray(name) || isObject(name) || isFunction(name)) {\n          oldValidationFlag = this.options.noValidation;\n          this.options.noValidation = true;\n          root = new XMLDocument(this.options).element('TEMP_ROOT');\n          root.element(name);\n          this.options.noValidation = oldValidationFlag;\n          ref1 = root.children;\n\n          for (i = 0, len = ref1.length; i < len; i++) {\n            child = ref1[i];\n            this.createChildNode(child);\n\n            if (child.type === NodeType.Element) {\n              this.up();\n            }\n          }\n        } else {\n          this.node(name, attributes, text);\n        }\n      }\n\n      return this;\n    };\n\n    XMLDocumentCB.prototype.attribute = function (name, value) {\n      var attName, attValue;\n\n      if (!this.currentNode || this.currentNode.children) {\n        throw new Error(\"att() can only be used immediately after an ele() call in callback mode. \" + this.debugInfo(name));\n      }\n\n      if (name != null) {\n        name = getValue(name);\n      }\n\n      if (isObject(name)) {\n        for (attName in name) {\n          if (!hasProp.call(name, attName)) continue;\n          attValue = name[attName];\n          this.attribute(attName, attValue);\n        }\n      } else {\n        if (isFunction(value)) {\n          value = value.apply();\n        }\n\n        if (this.options.keepNullAttributes && value == null) {\n          this.currentNode.attribs[name] = new XMLAttribute(this, name, \"\");\n        } else if (value != null) {\n          this.currentNode.attribs[name] = new XMLAttribute(this, name, value);\n        }\n      }\n\n      return this;\n    };\n\n    XMLDocumentCB.prototype.text = function (value) {\n      var node;\n      this.openCurrent();\n      node = new XMLText(this, value);\n      this.onData(this.writer.text(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.cdata = function (value) {\n      var node;\n      this.openCurrent();\n      node = new XMLCData(this, value);\n      this.onData(this.writer.cdata(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.comment = function (value) {\n      var node;\n      this.openCurrent();\n      node = new XMLComment(this, value);\n      this.onData(this.writer.comment(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.raw = function (value) {\n      var node;\n      this.openCurrent();\n      node = new XMLRaw(this, value);\n      this.onData(this.writer.raw(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.instruction = function (target, value) {\n      var i, insTarget, insValue, len, node;\n      this.openCurrent();\n\n      if (target != null) {\n        target = getValue(target);\n      }\n\n      if (value != null) {\n        value = getValue(value);\n      }\n\n      if (Array.isArray(target)) {\n        for (i = 0, len = target.length; i < len; i++) {\n          insTarget = target[i];\n          this.instruction(insTarget);\n        }\n      } else if (isObject(target)) {\n        for (insTarget in target) {\n          if (!hasProp.call(target, insTarget)) continue;\n          insValue = target[insTarget];\n          this.instruction(insTarget, insValue);\n        }\n      } else {\n        if (isFunction(value)) {\n          value = value.apply();\n        }\n\n        node = new XMLProcessingInstruction(this, target, value);\n        this.onData(this.writer.processingInstruction(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      }\n\n      return this;\n    };\n\n    XMLDocumentCB.prototype.declaration = function (version, encoding, standalone) {\n      var node;\n      this.openCurrent();\n\n      if (this.documentStarted) {\n        throw new Error(\"declaration() must be the first node.\");\n      }\n\n      node = new XMLDeclaration(this, version, encoding, standalone);\n      this.onData(this.writer.declaration(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.doctype = function (root, pubID, sysID) {\n      this.openCurrent();\n\n      if (root == null) {\n        throw new Error(\"Missing root node name.\");\n      }\n\n      if (this.root) {\n        throw new Error(\"dtd() must come before the root node.\");\n      }\n\n      this.currentNode = new XMLDocType(this, pubID, sysID);\n      this.currentNode.rootNodeName = root;\n      this.currentNode.children = false;\n      this.currentLevel++;\n      this.openTags[this.currentLevel] = this.currentNode;\n      return this;\n    };\n\n    XMLDocumentCB.prototype.dtdElement = function (name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDElement(this, name, value);\n      this.onData(this.writer.dtdElement(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.attList = function (elementName, attributeName, attributeType, defaultValueType, defaultValue) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDAttList(this, elementName, attributeName, attributeType, defaultValueType, defaultValue);\n      this.onData(this.writer.dtdAttList(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.entity = function (name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDEntity(this, false, name, value);\n      this.onData(this.writer.dtdEntity(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.pEntity = function (name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDEntity(this, true, name, value);\n      this.onData(this.writer.dtdEntity(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.notation = function (name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDNotation(this, name, value);\n      this.onData(this.writer.dtdNotation(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.up = function () {\n      if (this.currentLevel < 0) {\n        throw new Error(\"The document node has no parent.\");\n      }\n\n      if (this.currentNode) {\n        if (this.currentNode.children) {\n          this.closeNode(this.currentNode);\n        } else {\n          this.openNode(this.currentNode);\n        }\n\n        this.currentNode = null;\n      } else {\n        this.closeNode(this.openTags[this.currentLevel]);\n      }\n\n      delete this.openTags[this.currentLevel];\n      this.currentLevel--;\n      return this;\n    };\n\n    XMLDocumentCB.prototype.end = function () {\n      while (this.currentLevel >= 0) {\n        this.up();\n      }\n\n      return this.onEnd();\n    };\n\n    XMLDocumentCB.prototype.openCurrent = function () {\n      if (this.currentNode) {\n        this.currentNode.children = true;\n        return this.openNode(this.currentNode);\n      }\n    };\n\n    XMLDocumentCB.prototype.openNode = function (node) {\n      var att, chunk, name, ref1;\n\n      if (!node.isOpen) {\n        if (!this.root && this.currentLevel === 0 && node.type === NodeType.Element) {\n          this.root = node;\n        }\n\n        chunk = '';\n\n        if (node.type === NodeType.Element) {\n          this.writerOptions.state = WriterState.OpenTag;\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '<' + node.name;\n          ref1 = node.attribs;\n\n          for (name in ref1) {\n            if (!hasProp.call(ref1, name)) continue;\n            att = ref1[name];\n            chunk += this.writer.attribute(att, this.writerOptions, this.currentLevel);\n          }\n\n          chunk += (node.children ? '>' : '/>') + this.writer.endline(node, this.writerOptions, this.currentLevel);\n          this.writerOptions.state = WriterState.InsideTag;\n        } else {\n          this.writerOptions.state = WriterState.OpenTag;\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '<!DOCTYPE ' + node.rootNodeName;\n\n          if (node.pubID && node.sysID) {\n            chunk += ' PUBLIC \"' + node.pubID + '\" \"' + node.sysID + '\"';\n          } else if (node.sysID) {\n            chunk += ' SYSTEM \"' + node.sysID + '\"';\n          }\n\n          if (node.children) {\n            chunk += ' [';\n            this.writerOptions.state = WriterState.InsideTag;\n          } else {\n            this.writerOptions.state = WriterState.CloseTag;\n            chunk += '>';\n          }\n\n          chunk += this.writer.endline(node, this.writerOptions, this.currentLevel);\n        }\n\n        this.onData(chunk, this.currentLevel);\n        return node.isOpen = true;\n      }\n    };\n\n    XMLDocumentCB.prototype.closeNode = function (node) {\n      var chunk;\n\n      if (!node.isClosed) {\n        chunk = '';\n        this.writerOptions.state = WriterState.CloseTag;\n\n        if (node.type === NodeType.Element) {\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '</' + node.name + '>' + this.writer.endline(node, this.writerOptions, this.currentLevel);\n        } else {\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + ']>' + this.writer.endline(node, this.writerOptions, this.currentLevel);\n        }\n\n        this.writerOptions.state = WriterState.None;\n        this.onData(chunk, this.currentLevel);\n        return node.isClosed = true;\n      }\n    };\n\n    XMLDocumentCB.prototype.onData = function (chunk, level) {\n      this.documentStarted = true;\n      return this.onDataCallback(chunk, level + 1);\n    };\n\n    XMLDocumentCB.prototype.onEnd = function () {\n      this.documentCompleted = true;\n      return this.onEndCallback();\n    };\n\n    XMLDocumentCB.prototype.debugInfo = function (name) {\n      if (name == null) {\n        return \"\";\n      } else {\n        return \"node: <\" + name + \">\";\n      }\n    };\n\n    XMLDocumentCB.prototype.ele = function () {\n      return this.element.apply(this, arguments);\n    };\n\n    XMLDocumentCB.prototype.nod = function (name, attributes, text) {\n      return this.node(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.txt = function (value) {\n      return this.text(value);\n    };\n\n    XMLDocumentCB.prototype.dat = function (value) {\n      return this.cdata(value);\n    };\n\n    XMLDocumentCB.prototype.com = function (value) {\n      return this.comment(value);\n    };\n\n    XMLDocumentCB.prototype.ins = function (target, value) {\n      return this.instruction(target, value);\n    };\n\n    XMLDocumentCB.prototype.dec = function (version, encoding, standalone) {\n      return this.declaration(version, encoding, standalone);\n    };\n\n    XMLDocumentCB.prototype.dtd = function (root, pubID, sysID) {\n      return this.doctype(root, pubID, sysID);\n    };\n\n    XMLDocumentCB.prototype.e = function (name, attributes, text) {\n      return this.element(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.n = function (name, attributes, text) {\n      return this.node(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.t = function (value) {\n      return this.text(value);\n    };\n\n    XMLDocumentCB.prototype.d = function (value) {\n      return this.cdata(value);\n    };\n\n    XMLDocumentCB.prototype.c = function (value) {\n      return this.comment(value);\n    };\n\n    XMLDocumentCB.prototype.r = function (value) {\n      return this.raw(value);\n    };\n\n    XMLDocumentCB.prototype.i = function (target, value) {\n      return this.instruction(target, value);\n    };\n\n    XMLDocumentCB.prototype.att = function () {\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        return this.attList.apply(this, arguments);\n      } else {\n        return this.attribute.apply(this, arguments);\n      }\n    };\n\n    XMLDocumentCB.prototype.a = function () {\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        return this.attList.apply(this, arguments);\n      } else {\n        return this.attribute.apply(this, arguments);\n      }\n    };\n\n    XMLDocumentCB.prototype.ent = function (name, value) {\n      return this.entity(name, value);\n    };\n\n    XMLDocumentCB.prototype.pent = function (name, value) {\n      return this.pEntity(name, value);\n    };\n\n    XMLDocumentCB.prototype.not = function (name, value) {\n      return this.notation(name, value);\n    };\n\n    return XMLDocumentCB;\n  }();\n}).call(this);","map":{"version":3,"sources":["C:/Users/balwi/Documents/Coding/react-sfmc-api-poc/node_modules/xmlbuilder/lib/XMLDocumentCB.js"],"names":["NodeType","WriterState","XMLAttribute","XMLCData","XMLComment","XMLDTDAttList","XMLDTDElement","XMLDTDEntity","XMLDTDNotation","XMLDeclaration","XMLDocType","XMLDocument","XMLDocumentCB","XMLElement","XMLProcessingInstruction","XMLRaw","XMLStringWriter","XMLStringifier","XMLText","getValue","isFunction","isObject","isPlainObject","ref","hasProp","hasOwnProperty","require","module","exports","options","onData","onEnd","writerOptions","name","type","Document","writer","filterOptions","stringify","onDataCallback","onEndCallback","currentNode","currentLevel","openTags","documentStarted","documentCompleted","root","prototype","createChildNode","node","att","attName","attributes","child","i","len","ref1","ref2","CData","cdata","value","Comment","comment","Element","attribs","call","Dummy","dummy","Raw","raw","Text","text","ProcessingInstruction","instruction","target","Error","constructor","children","length","up","debugInfo","openCurrent","element","oldValidationFlag","DocType","dtdElement","apply","arguments","Array","isArray","noValidation","attribute","attValue","keepNullAttributes","insTarget","insValue","processingInstruction","declaration","version","encoding","standalone","doctype","pubID","sysID","rootNodeName","attList","elementName","attributeName","attributeType","defaultValueType","defaultValue","dtdAttList","entity","dtdEntity","pEntity","notation","dtdNotation","closeNode","openNode","end","chunk","isOpen","state","OpenTag","indent","endline","InsideTag","CloseTag","isClosed","None","level","ele","nod","txt","dat","com","ins","dec","dtd","e","n","t","d","c","r","a","ent","pent","not"],"mappings":"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","sourcesContent":["// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, WriterState, XMLAttribute, XMLCData, XMLComment, XMLDTDAttList, XMLDTDElement, XMLDTDEntity, XMLDTDNotation, XMLDeclaration, XMLDocType, XMLDocument, XMLDocumentCB, XMLElement, XMLProcessingInstruction, XMLRaw, XMLStringWriter, XMLStringifier, XMLText, getValue, isFunction, isObject, isPlainObject, ref,\n    hasProp = {}.hasOwnProperty;\n\n  ref = require('./Utility'), isObject = ref.isObject, isFunction = ref.isFunction, isPlainObject = ref.isPlainObject, getValue = ref.getValue;\n\n  NodeType = require('./NodeType');\n\n  XMLDocument = require('./XMLDocument');\n\n  XMLElement = require('./XMLElement');\n\n  XMLCData = require('./XMLCData');\n\n  XMLComment = require('./XMLComment');\n\n  XMLRaw = require('./XMLRaw');\n\n  XMLText = require('./XMLText');\n\n  XMLProcessingInstruction = require('./XMLProcessingInstruction');\n\n  XMLDeclaration = require('./XMLDeclaration');\n\n  XMLDocType = require('./XMLDocType');\n\n  XMLDTDAttList = require('./XMLDTDAttList');\n\n  XMLDTDEntity = require('./XMLDTDEntity');\n\n  XMLDTDElement = require('./XMLDTDElement');\n\n  XMLDTDNotation = require('./XMLDTDNotation');\n\n  XMLAttribute = require('./XMLAttribute');\n\n  XMLStringifier = require('./XMLStringifier');\n\n  XMLStringWriter = require('./XMLStringWriter');\n\n  WriterState = require('./WriterState');\n\n  module.exports = XMLDocumentCB = (function() {\n    function XMLDocumentCB(options, onData, onEnd) {\n      var writerOptions;\n      this.name = \"?xml\";\n      this.type = NodeType.Document;\n      options || (options = {});\n      writerOptions = {};\n      if (!options.writer) {\n        options.writer = new XMLStringWriter();\n      } else if (isPlainObject(options.writer)) {\n        writerOptions = options.writer;\n        options.writer = new XMLStringWriter();\n      }\n      this.options = options;\n      this.writer = options.writer;\n      this.writerOptions = this.writer.filterOptions(writerOptions);\n      this.stringify = new XMLStringifier(options);\n      this.onDataCallback = onData || function() {};\n      this.onEndCallback = onEnd || function() {};\n      this.currentNode = null;\n      this.currentLevel = -1;\n      this.openTags = {};\n      this.documentStarted = false;\n      this.documentCompleted = false;\n      this.root = null;\n    }\n\n    XMLDocumentCB.prototype.createChildNode = function(node) {\n      var att, attName, attributes, child, i, len, ref1, ref2;\n      switch (node.type) {\n        case NodeType.CData:\n          this.cdata(node.value);\n          break;\n        case NodeType.Comment:\n          this.comment(node.value);\n          break;\n        case NodeType.Element:\n          attributes = {};\n          ref1 = node.attribs;\n          for (attName in ref1) {\n            if (!hasProp.call(ref1, attName)) continue;\n            att = ref1[attName];\n            attributes[attName] = att.value;\n          }\n          this.node(node.name, attributes);\n          break;\n        case NodeType.Dummy:\n          this.dummy();\n          break;\n        case NodeType.Raw:\n          this.raw(node.value);\n          break;\n        case NodeType.Text:\n          this.text(node.value);\n          break;\n        case NodeType.ProcessingInstruction:\n          this.instruction(node.target, node.value);\n          break;\n        default:\n          throw new Error(\"This XML node type is not supported in a JS object: \" + node.constructor.name);\n      }\n      ref2 = node.children;\n      for (i = 0, len = ref2.length; i < len; i++) {\n        child = ref2[i];\n        this.createChildNode(child);\n        if (child.type === NodeType.Element) {\n          this.up();\n        }\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.dummy = function() {\n      return this;\n    };\n\n    XMLDocumentCB.prototype.node = function(name, attributes, text) {\n      var ref1;\n      if (name == null) {\n        throw new Error(\"Missing node name.\");\n      }\n      if (this.root && this.currentLevel === -1) {\n        throw new Error(\"Document can only have one root node. \" + this.debugInfo(name));\n      }\n      this.openCurrent();\n      name = getValue(name);\n      if (attributes == null) {\n        attributes = {};\n      }\n      attributes = getValue(attributes);\n      if (!isObject(attributes)) {\n        ref1 = [attributes, text], text = ref1[0], attributes = ref1[1];\n      }\n      this.currentNode = new XMLElement(this, name, attributes);\n      this.currentNode.children = false;\n      this.currentLevel++;\n      this.openTags[this.currentLevel] = this.currentNode;\n      if (text != null) {\n        this.text(text);\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.element = function(name, attributes, text) {\n      var child, i, len, oldValidationFlag, ref1, root;\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        this.dtdElement.apply(this, arguments);\n      } else {\n        if (Array.isArray(name) || isObject(name) || isFunction(name)) {\n          oldValidationFlag = this.options.noValidation;\n          this.options.noValidation = true;\n          root = new XMLDocument(this.options).element('TEMP_ROOT');\n          root.element(name);\n          this.options.noValidation = oldValidationFlag;\n          ref1 = root.children;\n          for (i = 0, len = ref1.length; i < len; i++) {\n            child = ref1[i];\n            this.createChildNode(child);\n            if (child.type === NodeType.Element) {\n              this.up();\n            }\n          }\n        } else {\n          this.node(name, attributes, text);\n        }\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.attribute = function(name, value) {\n      var attName, attValue;\n      if (!this.currentNode || this.currentNode.children) {\n        throw new Error(\"att() can only be used immediately after an ele() call in callback mode. \" + this.debugInfo(name));\n      }\n      if (name != null) {\n        name = getValue(name);\n      }\n      if (isObject(name)) {\n        for (attName in name) {\n          if (!hasProp.call(name, attName)) continue;\n          attValue = name[attName];\n          this.attribute(attName, attValue);\n        }\n      } else {\n        if (isFunction(value)) {\n          value = value.apply();\n        }\n        if (this.options.keepNullAttributes && (value == null)) {\n          this.currentNode.attribs[name] = new XMLAttribute(this, name, \"\");\n        } else if (value != null) {\n          this.currentNode.attribs[name] = new XMLAttribute(this, name, value);\n        }\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.text = function(value) {\n      var node;\n      this.openCurrent();\n      node = new XMLText(this, value);\n      this.onData(this.writer.text(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.cdata = function(value) {\n      var node;\n      this.openCurrent();\n      node = new XMLCData(this, value);\n      this.onData(this.writer.cdata(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.comment = function(value) {\n      var node;\n      this.openCurrent();\n      node = new XMLComment(this, value);\n      this.onData(this.writer.comment(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.raw = function(value) {\n      var node;\n      this.openCurrent();\n      node = new XMLRaw(this, value);\n      this.onData(this.writer.raw(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.instruction = function(target, value) {\n      var i, insTarget, insValue, len, node;\n      this.openCurrent();\n      if (target != null) {\n        target = getValue(target);\n      }\n      if (value != null) {\n        value = getValue(value);\n      }\n      if (Array.isArray(target)) {\n        for (i = 0, len = target.length; i < len; i++) {\n          insTarget = target[i];\n          this.instruction(insTarget);\n        }\n      } else if (isObject(target)) {\n        for (insTarget in target) {\n          if (!hasProp.call(target, insTarget)) continue;\n          insValue = target[insTarget];\n          this.instruction(insTarget, insValue);\n        }\n      } else {\n        if (isFunction(value)) {\n          value = value.apply();\n        }\n        node = new XMLProcessingInstruction(this, target, value);\n        this.onData(this.writer.processingInstruction(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.declaration = function(version, encoding, standalone) {\n      var node;\n      this.openCurrent();\n      if (this.documentStarted) {\n        throw new Error(\"declaration() must be the first node.\");\n      }\n      node = new XMLDeclaration(this, version, encoding, standalone);\n      this.onData(this.writer.declaration(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.doctype = function(root, pubID, sysID) {\n      this.openCurrent();\n      if (root == null) {\n        throw new Error(\"Missing root node name.\");\n      }\n      if (this.root) {\n        throw new Error(\"dtd() must come before the root node.\");\n      }\n      this.currentNode = new XMLDocType(this, pubID, sysID);\n      this.currentNode.rootNodeName = root;\n      this.currentNode.children = false;\n      this.currentLevel++;\n      this.openTags[this.currentLevel] = this.currentNode;\n      return this;\n    };\n\n    XMLDocumentCB.prototype.dtdElement = function(name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDElement(this, name, value);\n      this.onData(this.writer.dtdElement(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.attList = function(elementName, attributeName, attributeType, defaultValueType, defaultValue) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDAttList(this, elementName, attributeName, attributeType, defaultValueType, defaultValue);\n      this.onData(this.writer.dtdAttList(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.entity = function(name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDEntity(this, false, name, value);\n      this.onData(this.writer.dtdEntity(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.pEntity = function(name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDEntity(this, true, name, value);\n      this.onData(this.writer.dtdEntity(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.notation = function(name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDNotation(this, name, value);\n      this.onData(this.writer.dtdNotation(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.up = function() {\n      if (this.currentLevel < 0) {\n        throw new Error(\"The document node has no parent.\");\n      }\n      if (this.currentNode) {\n        if (this.currentNode.children) {\n          this.closeNode(this.currentNode);\n        } else {\n          this.openNode(this.currentNode);\n        }\n        this.currentNode = null;\n      } else {\n        this.closeNode(this.openTags[this.currentLevel]);\n      }\n      delete this.openTags[this.currentLevel];\n      this.currentLevel--;\n      return this;\n    };\n\n    XMLDocumentCB.prototype.end = function() {\n      while (this.currentLevel >= 0) {\n        this.up();\n      }\n      return this.onEnd();\n    };\n\n    XMLDocumentCB.prototype.openCurrent = function() {\n      if (this.currentNode) {\n        this.currentNode.children = true;\n        return this.openNode(this.currentNode);\n      }\n    };\n\n    XMLDocumentCB.prototype.openNode = function(node) {\n      var att, chunk, name, ref1;\n      if (!node.isOpen) {\n        if (!this.root && this.currentLevel === 0 && node.type === NodeType.Element) {\n          this.root = node;\n        }\n        chunk = '';\n        if (node.type === NodeType.Element) {\n          this.writerOptions.state = WriterState.OpenTag;\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '<' + node.name;\n          ref1 = node.attribs;\n          for (name in ref1) {\n            if (!hasProp.call(ref1, name)) continue;\n            att = ref1[name];\n            chunk += this.writer.attribute(att, this.writerOptions, this.currentLevel);\n          }\n          chunk += (node.children ? '>' : '/>') + this.writer.endline(node, this.writerOptions, this.currentLevel);\n          this.writerOptions.state = WriterState.InsideTag;\n        } else {\n          this.writerOptions.state = WriterState.OpenTag;\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '<!DOCTYPE ' + node.rootNodeName;\n          if (node.pubID && node.sysID) {\n            chunk += ' PUBLIC \"' + node.pubID + '\" \"' + node.sysID + '\"';\n          } else if (node.sysID) {\n            chunk += ' SYSTEM \"' + node.sysID + '\"';\n          }\n          if (node.children) {\n            chunk += ' [';\n            this.writerOptions.state = WriterState.InsideTag;\n          } else {\n            this.writerOptions.state = WriterState.CloseTag;\n            chunk += '>';\n          }\n          chunk += this.writer.endline(node, this.writerOptions, this.currentLevel);\n        }\n        this.onData(chunk, this.currentLevel);\n        return node.isOpen = true;\n      }\n    };\n\n    XMLDocumentCB.prototype.closeNode = function(node) {\n      var chunk;\n      if (!node.isClosed) {\n        chunk = '';\n        this.writerOptions.state = WriterState.CloseTag;\n        if (node.type === NodeType.Element) {\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '</' + node.name + '>' + this.writer.endline(node, this.writerOptions, this.currentLevel);\n        } else {\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + ']>' + this.writer.endline(node, this.writerOptions, this.currentLevel);\n        }\n        this.writerOptions.state = WriterState.None;\n        this.onData(chunk, this.currentLevel);\n        return node.isClosed = true;\n      }\n    };\n\n    XMLDocumentCB.prototype.onData = function(chunk, level) {\n      this.documentStarted = true;\n      return this.onDataCallback(chunk, level + 1);\n    };\n\n    XMLDocumentCB.prototype.onEnd = function() {\n      this.documentCompleted = true;\n      return this.onEndCallback();\n    };\n\n    XMLDocumentCB.prototype.debugInfo = function(name) {\n      if (name == null) {\n        return \"\";\n      } else {\n        return \"node: <\" + name + \">\";\n      }\n    };\n\n    XMLDocumentCB.prototype.ele = function() {\n      return this.element.apply(this, arguments);\n    };\n\n    XMLDocumentCB.prototype.nod = function(name, attributes, text) {\n      return this.node(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.txt = function(value) {\n      return this.text(value);\n    };\n\n    XMLDocumentCB.prototype.dat = function(value) {\n      return this.cdata(value);\n    };\n\n    XMLDocumentCB.prototype.com = function(value) {\n      return this.comment(value);\n    };\n\n    XMLDocumentCB.prototype.ins = function(target, value) {\n      return this.instruction(target, value);\n    };\n\n    XMLDocumentCB.prototype.dec = function(version, encoding, standalone) {\n      return this.declaration(version, encoding, standalone);\n    };\n\n    XMLDocumentCB.prototype.dtd = function(root, pubID, sysID) {\n      return this.doctype(root, pubID, sysID);\n    };\n\n    XMLDocumentCB.prototype.e = function(name, attributes, text) {\n      return this.element(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.n = function(name, attributes, text) {\n      return this.node(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.t = function(value) {\n      return this.text(value);\n    };\n\n    XMLDocumentCB.prototype.d = function(value) {\n      return this.cdata(value);\n    };\n\n    XMLDocumentCB.prototype.c = function(value) {\n      return this.comment(value);\n    };\n\n    XMLDocumentCB.prototype.r = function(value) {\n      return this.raw(value);\n    };\n\n    XMLDocumentCB.prototype.i = function(target, value) {\n      return this.instruction(target, value);\n    };\n\n    XMLDocumentCB.prototype.att = function() {\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        return this.attList.apply(this, arguments);\n      } else {\n        return this.attribute.apply(this, arguments);\n      }\n    };\n\n    XMLDocumentCB.prototype.a = function() {\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        return this.attList.apply(this, arguments);\n      } else {\n        return this.attribute.apply(this, arguments);\n      }\n    };\n\n    XMLDocumentCB.prototype.ent = function(name, value) {\n      return this.entity(name, value);\n    };\n\n    XMLDocumentCB.prototype.pent = function(name, value) {\n      return this.pEntity(name, value);\n    };\n\n    XMLDocumentCB.prototype.not = function(name, value) {\n      return this.notation(name, value);\n    };\n\n    return XMLDocumentCB;\n\n  })();\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}